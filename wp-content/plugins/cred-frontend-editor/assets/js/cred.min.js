!function(e,t,i,n,a,s,o){var r,l,c=27,d="_cred_cred_prefix_",u="	",h="\r\n",p=null,f=null,m={},g={toggleHighlight:function(){var e="0",i="switch-html",n="switch-tmce",a=t(this),s=a.closest(".wp-editor-wrap"),o=s.find(".ed_button"),r=s.find(".switch-text"),l=s.find(".switch-syntax"),c=s.find(".wp-switch-editor");a.hasClass("switch-text")?(o.show(),c.removeClass(i).addClass(n),r.removeClass(n).addClass(i),g.toggleCodeMirror(!1),e="0"):(o.hide(),c.removeClass(i).addClass(n),l.removeClass(n).addClass(i),g.toggleCodeMirror(!0),e="1"),t.ajax({url:v.route("/Settings/toggleHighlight"),timeout:1e4,type:"POST",data:{cred_highlight:e},dataType:"html",success:function(){},error:function(){}})},makeResizable:function(i){var a,s=!1,o=i.attr("id"),r=function(){m[o]&&m[o].setSize(i.width(),i.height())};n.waitUntilElement("#content-resize-handle",function(){t("#content-resize-handle").on("mousedown",function(){s||(s=!0,a=setInterval(r,100))}),t(document).on("mouseup",function(){s&&(clearInterval(a),s=!1)}),t(e).resize(function(){r()})})},makeAreaResizable:function(i){!function(){function a(e){return i.height(Math.max(50,c+e.pageY)+"px"),l(),!1}function s(){var e;i.focus(),t(document).unbind("mousemove",a).unbind("mouseup",s),e=parseInt(i.css("height"),10),e&&e>50&&5e3>e&&n.setUserSetting("cred_settings",r+"_size",e)}var o,r=i.attr("id"),l=function(){m[r]&&m[r].setSize(i.width(),i.height())},c=null;!i.length||"ontouchstart"in e||(i.css("resize","none"),o=i.closest(".cred-editor-wrap").find(".cred-content-resize-handle"),o.on("mousedown",function(e){return c=i.height()-e.pageY,i.blur(),t(document).mousemove(a).mouseup(s),!1}))}()},enableExtraCodeMirror:function(){if(e.CodeMirror){var i,a=t("#cred-extra-css-editor"),s=t("#cred-extra-js-editor");n.swapEl(a,function(){m["cred-extra-css-editor"]=CodeMirror.fromTextArea(a[0],{mode:"css",tabMode:"indent",lineWrapping:!0,lineNumbers:!0}),i=Math.min(5e3,Math.max(50,n.getUserSetting("cred_settings","cred-extra-css-editor_size",300))),a.css("resize","none").height(i+"px"),m["cred-extra-css-editor"].setSize(null,i),g.makeAreaResizable(a)}),a.hide(),n.swapEl(s,function(){m["cred-extra-js-editor"]=CodeMirror.fromTextArea(s[0],{mode:"javascript",tabMode:"indent",lineWrapping:!0,lineNumbers:!0}),i=Math.min(5e3,Math.max(50,n.getUserSetting("cred_settings","cred-extra-js-editor_size",300))),s.css("resize","none").height(i+"px"),m["cred-extra-js-editor"].setSize(null,i),g.makeAreaResizable(s)}),s.hide()}},toggleCodeMirror:function(i){var n;if(e.CodeMirror){if(!i&&m.content)return m.content.toTextArea(),m.content=!1,!i;if(i&&!m.content){CodeMirror.defineMode("myshortcodes",codemirror_shortcodes_overlay);var a=t("#content").closest(".postbox"),s=!1,o=!1;(a.hasClass("closed")||"none"==a.css("display"))&&(s=!0,a.removeClass("closed")),"none"==a.css("display")&&(o="none",a.css("display","block")),m.content=CodeMirror.fromTextArea(document.getElementById("content"),{mode:"myshortcodes",tabMode:"indent",lineWrapping:!0,lineNumbers:!0,onKeyEvent:function(e,t){var i=t.keyCode||t.charCode;i!=n&&((13==i||8==n||46==n)&&jQuery(document).triggerHandler("wpcountwords",[e.getValue()]),n=i)}});var r=Math.min(5e3,Math.max(50,getUserSetting("ed_size")));return t("#content").css("resize","none").height(r+"px"),m.content.setSize(t("#content").width(),r),"none"==o&&a.css("display","none"),s&&a.addClass("closed"),i}}return!1},genScaffold:function(){var e=f;if(!e||!e.post_fields)return a.Popups.alert({message:i.locale.form_types_not_set,"class":"cred-dialog"}),!1;var n=!1;t("#cred_include_wpml_scaffold").is(":checked")&&(n=!0);var s=t("#title").val();if(""==t.trim(s))return a.Popups.alert({message:i.locale.set_form_title,"class":"cred-dialog"}),!1;var o=t("#post_ID").val(),l=t("#cred-scaffold-area"),c="",d={},p=0;for(var m in e.groups)if(e.groups.hasOwnProperty(m)){p++;var v=e.groups[m];d[m]=v,v=v.split(","),c+=g.groupOutput(m,v,e.custom_fields,o,s,n,u)+h}var y="";if(parseInt(e.taxonomies_count,10)>0)for(var m in e.taxonomies)e.taxonomies.hasOwnProperty(m)&&(y+=g.taxOutput(e.taxonomies[m],o,s,n,"")+h);var _="";if(parseInt(e.parents_count,10)>0)for(var m in e.parents)e.parents.hasOwnProperty(m)&&(_+=g.fieldOutput(e.parents[m],o,s,n,"","date","desc",0,!1,"No Parent","-- Select "+e.parents[m].data.post_type+" --",e.parents[m].data.post_type+" must be selected")+h);var b="";return b+="minimal"==r.get("[form][theme]")?'[credform class="cred-form cred-keep-original"]'+h+h:'[credform class="cred-form"]'+h+h,b+=u+g.shortcode(e.form_fields.form_messages)+h+h,b+=g.fieldOutput(e.post_fields.post_title,o,s,n,u)+h+h,e.post_fields.post_content.supports&&(b+=g.fieldOutput(e.post_fields.post_content,o,s,n,u)+h+h),e.post_fields.post_excerpt.supports&&(b+=g.fieldOutput(e.post_fields.post_excerpt,o,s,n,u)+h+h),e.extra_fields._featured_image.supports&&(b+=g.fieldOutput(e.extra_fields._featured_image,o,s,n,u)+h+h),b+=c,parseInt(e.taxonomies_count,10)>0&&(b+=g.groupOutputContent("taxonomies","Taxonomies",y,u)+h+h),parseInt(e.parents_count,10)>0&&(b+=g.groupOutputContent("parents","Parents",_,u)+h+h),t("#cred_include_captcha_scaffold").is(":checked")&&(b+=u+'<div class="cred-field cred-field-recaptcha">'+g.shortcode(e.extra_fields.recaptcha)+"</div>"+h+h),b+=u+g.shortcode(e.form_fields.form_submit)+h+h,b+="[/credform]"+h,l.val(b),!0},onLoad:function(e){var n,a,s=null,o=t("#cred-shortcodes-box-inner");if(o.empty(),f=e,e.form_fields&&parseInt(e.form_fields_count)>0){n=t('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.form_fields+"</a></div>"),a=t('<div class="cred-accordeon-item-inside"></div>'),n.append(a),o.append(n),resp2=e.form_fields;for(var r in resp2)resp2.hasOwnProperty(r)&&(s=t("<a href='javascript:;' class='button cred_field_add' title='"+resp2[r].description+"'>"+resp2[r].name+"</a>"),s.data("field",resp2[r]),a.append(s))}if(e.post_fields&&parseInt(e.post_fields_count)>0){n=t('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.post_fields+"</a></div>"),a=t('<div class="cred-accordeon-item-inside"></div>'),n.append(a),o.append(n),resp2=e.post_fields;for(var r in resp2)resp2.hasOwnProperty(r)&&(s=t("<a href='javascript:;' class='button cred_field_add' title='"+resp2[r].description+"'>"+resp2[r].name+"</a>"),s.data("field",resp2[r]),a.append(s))}if(e.custom_fields&&parseInt(e.custom_fields_count)>0){n=t('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.custom_fields+"</a></div>"),a=t('<div class="cred-accordeon-item-inside"></div>'),n.append(a),o.append(n),resp2=e.custom_fields;for(var r in resp2)resp2.hasOwnProperty(r)&&(s=t("<a href='javascript:;' class='button cred_field_add' title='"+resp2[r].description+"'>"+resp2[r].name+"</a>"),s.data("field",resp2[r]),a.append(s))}if(e.taxonomies&&parseInt(e.taxonomies_count)>0){n=t('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.taxonomy_fields+"</a></div>"),a=t('<div class="cred-accordeon-item-inside"></div>'),n.append(a),o.append(n),resp2=e.taxonomies;for(var r in resp2)resp2.hasOwnProperty(r)&&(resp2[r].taxonomy=!0,s=t("<a href='javascript:;' class='button cred_field_add'>"+resp2[r].label+"</a>"),s.data("field",resp2[r]),a.append(s),resp2[r].hierarchical?(resp2[r].aux={master_taxonomy:resp2[r].name,name:resp2[r].name+"_add_new",add_new_taxonomy:!0},s=t("<a href='javascript:;' class='button cred_field_add'>"+resp2[r].label+" Add New"+"</a>"),s.data("field",resp2[r].aux),a.append(s)):(resp2[r].aux={master_taxonomy:resp2[r].name,name:resp2[r].name+"_popular",popular:!0},s=t("<a href='javascript:;' class='button cred_field_add'>"+resp2[r].label+" Popular"+"</a>"),s.data("field",resp2[r].aux),a.append(s)))}if(e.parents&&parseInt(e.parents_count)>0){n=t('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.parent_fields+"</a></div>"),a=t('<div class="cred-accordeon-item-inside"></div>'),n.append(a),o.append(n),resp2=e.parents;for(var r in resp2)resp2.hasOwnProperty(r)&&(s=t("<a href='javascript:;' class='button cred_field_add' title='"+resp2[r].description+"'>"+resp2[r].name+"</a>"),s.data("field",resp2[r]),a.append(s))}if(e.extra_fields&&parseInt(e.extra_fields_count)>0){n=t('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.extra_fields+"</a></div>"),a=t('<div class="cred-accordeon-item-inside"></div>'),n.append(a),o.append(n),resp2=e.extra_fields;var l=[];for(var r in resp2)resp2.hasOwnProperty(r)&&(resp2[r].disabled?(s=t("<div class='cred_disabled_container'><a href='javascript:;' class='button cred_field_disabled' disabled='disabled'>"+resp2[r].name+"</a><span class='cred-field-disabled-reason'>"+resp2[r].disabled_reason+"</span></div>"),s.data("field",resp2[r]),l.push(s)):(s=t("<a href='javascript:;' class='button cred_field_add' title='"+resp2[r].description+"'>"+resp2[r].name+"</a>"),s.data("field",resp2[r]),a.append(s)));for(var c=0;c<l.length;c++)a.append(l[c])}},shortcode:function(e,t){var i="",n="",a=' value=""';if(e&&e.slug){if(e.post_type&&(n=' post="'+e.post_type+'"'),e.value&&(a=' value="'+e.value+'"'),e.taxonomy||e.is_parent||"form_messages"==e.type||(a+=' urlparam=""'),"image"==e.type||"file"==e.type){var s=t&&t.max_width?t.max_width:!1,o=t&&t.max_height?t.max_height:!1;s&&!isNaN(s)&&(a+=' max_width="'+s+'"'),o&&!isNaN(o)&&(a+=' max_height="'+o+'"')}if(e.is_parent){var r=t&&t.parent_order?t.parent_order:!1,l=t&&t.parent_ordering?t.parent_ordering:!1,c=t&&t.parent_max_results?t.parent_max_results:!1,d=t&&t.required?t.required:!1,u=t&&t.no_parent_text?t.no_parent_text:!1,h=t&&t.select_parent_text?t.select_parent_text:!1,p=t&&t.validate_parent_text?t.validate_parent_text:!1;c===!1||isNaN(c)||(a+=' max_results="'+c+'"'),r&&(a+=' order="'+r+'"'),l&&(a+=' ordering="'+l+'"'),d&&(a+=' required="'+d.toString()+'"'),d&&h!==!1&&(a+=' select_text="'+h+'"'),d&&p!==!1&&(a+=' validate_text="'+p+'"'),d||u===!1||(a+=' no_parent_text="'+u+'"')}if("textfield"==e.type||"textarea"==e.type||"wysiwyg"==e.type||"date"==e.type||"phone"==e.type||"url"==e.type||"numeric"==e.type||"email"==e.type){var f=t&&t.readonly?t.readonly:!1,m=t&&t.escape?t.escape:!1,g=t&&t.placeholder?t.placeholder:!1;f&&(a+=' readonly="'+f.toString()+'"'),m&&(a+=' escape="'+m.toString()+'"'),g&&""!=g&&(a+=' placeholder="'+g+'"')}i='[cred_field field="'+e.slug+'"'+n+a+"]"}return e&&e.taxonomy&&(i=e.hierarchical?'[cred_field field="'+e.name+'" display="checkbox"]':'[cred_field field="'+e.name+'"]'),e&&e.popular&&(i='[cred_field field="'+e.name+'" taxonomy="'+e.master_taxonomy+'" type="show_popular"]'),e&&e.add_new_taxonomy&&(i='[cred_field field="'+e.name+'" taxonomy="'+e.master_taxonomy+'" type="add_new"]'),i},fieldOutput:function(e,t,i,n,a){a||(a="");var s=[];if(n=n||!1,e){n?(s.push(a+'<div class="cred-field cred-field-'+e.slug+'">'),s.push(a+u+'<div class="cred-label">[wpml-string context="cred-form-'+i+"-"+t+'" name="'+e.name+'"]'+e.name+"[/wpml-string]</div>")):(s.push(a+'<div class="cred-field cred-field-'+e.slug+'">'),s.push(a+u+'<div class="cred-label">'+e.name+"</div>"));var o=[e];o=5==arguments.length?o.concat(Array.prototype.slice.call(arguments,6)):o.concat(Array.prototype.slice.call(arguments,5)),s.push(a+u+g.shortcode.apply(null,o)),s.push(a+"</div>")}return s.join(h)},groupOutput:function(e,t,i,n,a,s,o){o||(o="");var r=[],l="cred-group-"+e.replace(/\s+/g,"-");r.push(o+'<div class="cred-group '+l+'">'),s?r.push(o+u+'<div><h2>[wpml-string context="cred-form-'+a+"-"+n+'" name="'+e+'"]'+e+"[/wpml-string]</h2></div>"):r.push(o+u+"<div><h2>"+e+"</h2></div>");for(var c=0;c<t.length;c++)i[t[c]]._cred_ignore||r.push(g.fieldOutput(i[t[c]],n,a,s,o+u));return r.push(o+"</div>"),r.join(h)+h},groupOutputContent:function(e,t,i,n){n||(n="");var a=[],s="cred-group-"+e.replace(/\s+/g,"-");a.push(n+'<div class="cred-group '+s+'">');for(var o=i.split(h),r=0;r<o.length;r++)o[r]=n+u+o[r];return i=o.join(h),a.push(i),a.push(n+"</div>"),a.join(h)},taxOutput:function(e,t,i,n,a){n=n||!1,a||(a="");var s=[];return s.push(a+'<div class="cred-taxonomy cred-taxonomy-'+e.name+'">'),n?s.push(a+u+'<div class="cred-label"><h2>[wpml-string context="cred-form-'+i+"-"+t+'" name="'+e.label+'"]'+e.label+"[/wpml-string]</h2></div>"):s.push(a+u+'<div class="cred-label"><h2>'+e.label+"</h2></div>"),s.push(a+u+g.shortcode(e)),s.push(a+u+'<div class="cred-taxonomy-auxilliary cred-taxonomy-auxilliary-'+e.aux.name+'">'),s.push(a+u+u+g.shortcode(e.aux)),s.push(a+u+"</div>"),s.push(a+"</div>"),s.join(h)},formPreview:function(){var s=n.getContent(t("#content"));if(""==t.trim(s))return!1;var o,l,c,u,h,p=r.get("[post][post_type]"),f=r.get("[form][type]"),m=r.get("[form][theme]"),g=n.getContent(t("#cred-extra-css-editor")),v=n.getContent(t("#cred-extra-js-editor"));return p&&""!=p&&f&&""!=f?(c=t("#post_ID").val(),u="CRED_Preview_"+c,h=i.homeurl+"index.php?cred_form_preview="+c,l=e.open("",u,"status=0,title=0,height=600,width=800,scrollbars=1,resizable=1"),l?(o=t("<form style='display:none' name='cred_form_preview_form' method='post' target='"+u+"' action='"+h+"'><input type='hidden' name='"+d+"form_css_to_use' value='"+m+"' /><input type='hidden' name='"+d+"form_preview_post_type' value='"+p+"' /><input type='hidden' name='"+d+"form_preview_form_type' value='"+f+"' /><textarea  name='"+d+"form_preview_content'>"+n.stripslashes(s)+"</textarea><textarea  name='"+d+"extra_css_to_use'>"+g+"</textarea><textarea  name='"+d+"extra_js_to_use'>"+v+"</textarea></form>"),t(document.body).append(o),o.submit(),setTimeout(function(){o.remove()},1e3)):a.Popups.alert({message:i.locale.enable_popup_for_preview,"class":"cred-dialog"}),!1):(a.Popups.alert({message:i.locale.form_types_not_set,"class":"cred-dialog"}),!1)}},v={app:n,gui:a,mvc:s,settings:i,route:function(e,t,a){return n.route("cred",i.ajaxurl,e,t,a)},getFormFields:function(e){if(!f)return[];var t,i,a,s,o,r,l,c,d,u=n.getContent(e).replace(/[\n\r]+/g," "),h=f,p=[{rx:/\[cred[\-_]field\b[^\[\]]*field=[\"\']([\d\w\-_]+)[\"\'][^\[\]]*value=[\"\']([\w\-\[\]\"\'=\s]+)?[\"\'][^\[\]]*?\]/g,field:1,type:!1,generic:!1},{rx:/\[cred\-generic\-field\b([^\[\]]*?)\](.+?)\[\/cred\-generic\-field\]/g,atts:1,content:2,generic:!0},{rx:/\[cred_generic_field\b([^\[\]]*?)\](.+?)\[\/cred_generic_field\]/g,atts:1,content:2,generic:!0}],m=[],g=/field=[\"\']([\d\w\-_]+?)[\"\'][^\[\]]*?\btype=[\"\']([\d\w\-_]+?)[\"\']/,v=/type=[\"\']([\d\w\-_]+?)[\"\'][^\[\]]*?\bfield=[\"\']([\d\w\-_]+?)[\"\']/,y=/["']persist["']\s*\:\s*(\d)/,_=/["']generic_type["']\s*\:\s*["']([\w_]+)["']/;for(t=0,i=p.length;i>t;t++)if(p[t].generic)for(;a=p[t].rx.exec(u);){o=!1,r=!1,s=o,l=!1,c=!0,d=!1;var b=p[t].atts&&a[p[t].atts]?g.exec(a[p[t].atts]):!1,w=p[t].atts&&a[p[t].atts]?v.exec(a[p[t].atts]):!1,$=p[t].content&&a[p[t].content]?y.exec(a[p[t].content]):!1,x=p[t].content&&a[p[t].content]?_.exec(a[p[t].content]):!1;if(b)o=b[1],r=b[2],s=o;else{if(!w)continue;r=w[1],o=w[2],s=o}d=$&&$[1]&&"1"==$[1]?!0:!1,x&&x[1]&&""!=x[1]&&(r=x[1]),m.push({name:o,field:o,type:r,repetitive:l,persistent:d,generic:c})}else for(;a=p[t].rx.exec(u);)o=!1,r=!1,s=o,l=!1,c=!1,d=!0,o=!1!==p[t].field&&a[p[t].field]?a[p[t].field]:!1,r=!1!==p[t].type&&a[p[t].type]?a[p[t].type]:!1,s=o,l=!1,c=!1,d=!0,o&&(h.post_fields[o]?(r=h.post_fields[o].type,h.post_fields[o].data&&h.post_fields[o].data.repetitive&&"1"==h.post_fields[o].data.repetitive&&(l=!0),h.post_fields[o].plugin_type_prefix&&(o=h.post_fields[o].plugin_type_prefix+s),m.push({name:s,field:o,type:r,repetitive:l,persistent:d,generic:c})):h.custom_fields[o]?(r=h.custom_fields[o].type,h.custom_fields[o].data&&h.custom_fields[o].data.repetitive&&"1"==h.custom_fields[o].data.repetitive&&(l=!0),h.custom_fields[o].plugin_type_prefix&&(o=h.custom_fields[o].plugin_type_prefix+s),m.push({name:s,field:o,type:r,repetitive:l,persistent:d,generic:c})):h.parents[o]?(r=h.parents[o].type,h.parents[o].data&&h.parents[o].data.repetitive&&"1"==h.parents[o].data.repetitive&&(l=!0),h.parents[o].plugin_type_prefix&&(o=h.parents[o].plugin_type_prefix+s),m.push({name:s,field:o,type:r,repetitive:l,persistent:d,generic:c})):h.taxonomies[o]&&(r="taxonomy",h.taxonomies[o].plugin_type_prefix&&(o=h.taxonomies[o].plugin_type_prefix+s),m.push({name:s,field:o,type:r,repetitive:l,persistent:d,generic:c})));return m},doCheck:function(){var e=t("#title").val();return/[\#\@\[\]\'\"\!\/\\]/g.test(e)||e.length<=0?(a.Popups.alert({message:i.locale.invalid_title,"class":"cred-dialog"}),!1):!0},getContents:function(){return{content:n.getContent(t("#content")),"cred-extra-css-editor":n.getContent(t("#cred-extra-css-editor")),"cred-extra-js-editor":n.getContent(t("#cred-extra-js-editor"))}},getFieldData:function(){return f},getCodeMirror:function(){return m.content},getCSSCodeMirror:function(){return m["cred-extra-css-editor"]},getJSCodeMirror:function(){return m["cred-extra-js-editor"]},getModel:function(){return r},getView:function(){return l},forms:function(d){var u=!0,y=t("#post"),_=(t("#credformtypediv"),t("#credposttypediv"),t("#credformcontentdiv"),t("#postdivrich")),b=t("#credextradiv"),w=(t("#credmessagesdiv"),t("#crednotificationdiv"),t("#cred_ajax_loader_small_id"));r=new s.Model("_cred",e._credFormData),l=new s.View("cred",r,{init:function(){function s(){d.isValid=!0,d.getElements(".cred_validation_section").each(function(){var e=t(this),i=!0;e.find("input, select, textarea").each(function(){var e=t(this);o!==e[0].__isCredValid&&(e[0].__isCredValid||(i=!1))}),i?t(".cred-notification.cred-error.cred-section-validation-message",e).delay(100).hide(0):(d.isValid=!1,t(".cred-notification.cred-error.cred-section-validation-message",e).delay(100).show(0))})}function l(){if(f&&f.post_fields){for(var e=v.getFormFields(),i=[],n=[],a=[],s=[],o=0,r=e.length;r>o;o++)e[o].persistent&&(("mail"==e[o].type||"email"==e[o].type)&&i.push({value:e[o].field,label:e[o].name}),"user_id"==e[o].type&&n.push({value:e[o].field,label:e[o].name}),-1!=t.inArray(e[o].field,["post_title","post_content","post_excerpt"])||"text"!=e[o].type&&"textfield"!=e[o].type||a.push({value:e[o].field,label:e[o].name}),("select"==e[o].type||"radio"==e[o].type)&&s.push({value:e[o].field,label:e[o].name}));u.set("[_persistent_mail_fields]",i).set("[_persistent_user_id_fields]",n).set("[_persistent_text_fields]",a).set("[_persistent_select_fields]",s).set("[_all_persistent_meta_fields]",[].concat(i,n,a,s)).trigger("change")}}var d=this,u=this._model;d.isValid=!0,d.action("styleForm",function(e){var i=n.isCodeMirror(t("#content"));if(i){i.focus(),i.execCommand("selectAll");var a=n.getContent(t("#content")).replace(/[\n\r]+/g,"%%NL%%");a=a.replace(/\[credform([^\]]*) class="(.*?)[\s]*?cred-keep-original(.*?)"([^\]]*)\]/gi,'[credform$1 class="$2$3"$4]'),"minimal"==e.val()&&(a=a.replace(/\[credform(((?!class="(.*?)")[^\]])*)\]/gi,'[credform$1 class=""]'),a=a.replace(/\[credform([^\]]*) class="(.*?)"([^\]]*)\]/gi,'[credform$1 class="%%SPLIT%%$2 cred-keep-original%%SPLIT%%"$3]').split("%%SPLIT%%"),a[1]=t.trim(a[1]),a=a.join("")),n.InsertAtCursor(t("#content"),a.replace(/%%NL%%/g,h))}}).action("refreshFormFields",function(){l(),a.Popups.flash({message:i.locale.refresh_done,"class":"cred-dialog"})}).action("validateSection",function(e,t){e[0]&&t&&o!==t.validationResult&&(e[0].__isCredValid=t.validationResult)}).action("fadeSlide",function(e,i){i.bind&&(i=i.bind,i.domRef&&(e=t(i.domRef)),i.condition?(i.condition=u.eval(i.condition),o!==i.condition&&(i.condition?e.slideFadeDown("slow","quintEaseOut"):e.slideFadeUp("slow","quintEaseOut"))):e.slideFadeDown("slow","quintEaseOut"))}).action("fadeIn",function(e,i){i.bind&&(i=i.bind,i.domRef&&(e=t(i.domRef)),i.condition?(i.condition=u.eval(i.condition),o!==i.condition&&(i.condition?e.stop().fadeIn("slow"):e.stop().fadeOut("slow",function(){t(this).hide()}))):e.stop().fadeIn("slow"))}).func("confirm",function(e,n){a.Popups.confirm({message:e,"class":"cred-dialog",buttons:[i.locale.Yes,i.locale.No],primary:i.locale.Yes,callback:function(e){t.isFunction(n)&&(e==i.locale.Yes?n.call(d,!0):n.call(d,!1))}})}).event("model:change",function(i,a){if("[post][post_type]"==a.key)w.show(),t.ajax({url:v.route("/Forms/getPostFields"),timeout:1e4,type:"POST",data:"post_type="+a.value,dataType:"json",success:function(e){g.onLoad(e),n.dispatch("cred.fieldsLoaded"),w.hide()}});else if(/^\[notification\]\[notifications\]\[\d+\]/.test(a.key)){var o=/^\[notification\]\[notifications\]\[(\d+)\]$/.exec(a.key);if(o){if(e.tinyMCEPreInit){var r="credmailbody"+o[1];if("object"==typeof e.tinyMCE&&e.tinyMCEPreInit.mceInit.credmailbody__i__)if(e.tinyMCEPreInit.mceInit[r])try{e.tinyMCE.get(r)&&(e.tinyMCE.execCommand("mceFocus",!1,r),e.tinyMCE.execCommand("mceRemoveControl",!1,r)),delete e.tinyMCEPreInit.mceInit[r]}catch(i){}else{e.tinyMCEPreInit.mceInit[r]=e.tinyMCE.extend({},e.tinyMCEPreInit.mceInit.credmailbody__i__);for(var l in{body_class:1,elements:1})e.tinyMCEPreInit.mceInit[r][l]&&(e.tinyMCEPreInit.mceInit[r][l]=e.tinyMCEPreInit.mceInit[r][l].replace(/__i__/g,o[1]));try{new e.tinyMCE.Editor(r,e.tinyMCEPreInit.mceInit[r]).render()}catch(i){}var c=e.tinyMCE.DOM;c.events.add(c.select("#wp-"+r+"-wrap"),"mousedown",function(){this.id&&(e.wpActiveEditor=e.wpcfActiveEditor=this.id.slice(3,-5))})}if(e.tinyMCEPreInit.qtInit&&e.tinyMCEPreInit.qtInit.credmailbody__i__)if(e.tinyMCEPreInit.qtInit[r])try{delete e.tinyMCEPreInit.qtInit[r]}catch(i){}else{e.tinyMCEPreInit.qtInit[r]=t.extend({},e.tinyMCEPreInit.qtInit.credmailbody__i__);for(var l in{id:1})e.tinyMCEPreInit.qtInit[r][l]&&(e.tinyMCEPreInit.qtInit[r][l]=e.tinyMCEPreInit.qtInit[r][l].replace(/__i__/g,o[1]));if("object"!=typeof e.tinyMCE){var u=e.tinyMCEPreInit.qtInit[r].id;document.getElementById("wp-"+u+"-wrap").onmousedown=function(){e.wpActiveEditor=e.wpcfActiveEditor=this.id.slice(3,-5)}}if("function"==typeof e.QTags){var h,p=e.QTags.instances;e.QTags.instances={};try{h=e.quicktags(e.tinyMCEPreInit.qtInit[r]),e.QTags.instances[r]=h,e.QTags._buttonsInit()}catch(i){}e.QTags.instances=p,e.QTags.instances[r]=h,t("#wp-"+r+"-wrap").removeClass("html-active").addClass("tmce-active"),e.tinyMCE.get(r)&&e.switchEditors.switchto(document.getElementById(r+"-tmce"))}}}}else{var o=/^\[notification\]\[notifications\]\[(\d+)\]\[event\]\[type\]$/.exec(a.key);if(o){var f=d.getElements("#cred_mail_subject_placeholders-"+o[1]).find("a.cred_field_add_code").add(d.getElements("#cred_mail_body_placeholders-"+o[1]).find("a.cred_field_add_code"));"form_submit"==a.value?f.filter(function(){var e=t(this).data("value");return t.inArray(e,["%%FORM_DATA%%","%%POST_PARENT_TITLE%%","%%POST_PARENT_LINK%%"])>-1?!0:!1}).prop("disabled",!1).show():f.filter(function(){var e=t(this).data("value");return t.inArray(e,["%%FORM_DATA%%","%%POST_PARENT_TITLE%%","%%POST_PARENT_LINK%%"])>-1?!0:!1}).prop("disabled",!0).hide(),n.dispatch("cred.notificationEventChanged",a.value,f)}}}s()}).event("view:change",function(e,t){t.el&&t.bind&&t.el.hasClass("cred-notification-add-button"),s()}),n.attach("cred.fieldsLoaded cred.insertField cred.insertScaffold",l),n.attach("cred.wizardFinished",function(){for(codemirror in m)if("content"==codemirror){var e=t("#"+codemirror).closest(".postbox");e.hasClass("closed")||"none"==e.css("display")||m[codemirror].setSize(t("#"+codemirror).width(),t("#"+codemirror).height())}}),y.on("click",".cred-tip-link .icon-question-sign",function(e){e.preventDefault(),e.stopPropagation();var i=t(this),n=i.parent();return i.hasClass("active")?(i[0]._pointer&&i[0]._pointer.pointer("close"),void 0):(i.addClass("active"),i[0]._pointer=a.Popups.pointer(n,{message:t(n.data("pointer-content")).html(),"class":"cred-pointer",callback:function(){i.removeClass("active")}}),void 0)}).on("click",".cred_field_add_code",function(e){e.stopPropagation(),e.preventDefault();var i=t(this),a=t(i.data("area")),s=i.data("value");return n.InsertAtCursor(a,s),setTimeout(function(){i.closest(".cred-popup-box").__hide(),i.closest(".cred-icon-button").css("z-index",1)},50),!1}).on("paste keyup change",".js-test-notification-to",function(){var e=t(this),i=e.val(),n=t(e.data("sendbutton"));""==i?n.attr("disabled","disabled"):n.removeAttr("disabled")}).on("click",".js-send-test-notification",function(i){i.preventDefault();var n,s=t(this),o=null,r={},l=t.trim(t(s.data("addressfield")).val()),c=t(s.data("cancelbutton")),d=t(s.data("loader")),h=t(s.data("results")).empty().hide(),p=t("#post_ID").val();if(""==l)return!1;var f=function(){o&&(o.abort(),o=!1),c.unbind("click",f),s.removeAttr("disabled")},m="credmailbody"+s.data("notification");if("object"==typeof e.tinyMCE&&e.tinyMCEPreInit.mceInit[m]){var g=e.tinyMCE.get(m);if(g){var y=g.getContent();u.set("[notification][notifications]["+s.data("notification")+"][mail][body]",y,!0)}}r=t.extend(r,u.get("[notification][notifications]["+s.data("notification")+"]")),delete r.event,r.to.type=["specific_mail"],r.to.specific_mail.address=l,n={cred_test_notification_data:r,cred_form_id:p},c.unbind("click",f).bind("click",f),s.attr("disabled","disabled"),h.html("sending test notification to &quot;"+l+"&quot; ..").show(),d.show(),o=t.ajax(v.route("/Forms/testNotification"),{data:n,dataType:"json",type:"POST",success:function(e){e.error?h.html('<div class="cred-error">'+e.error+"</div>"):h.html('<div class="cred-success">'+e.success+"</div>"),h.hide().fadeIn("slow"),d.hide(),o=!1,f()},error:function(e){d.hide(),h.empty().hide(),a.Popups.alert({message:"AJAX Request failed!<br /><br />Response Code: "+e.status+"<br /><br />Response Message: "+e.responseText,"class":"cred-dialog"}),o=!1,f()}})}),t("#cred-preview-button a").unbind("click").bind("click",function(e){return e.preventDefault(),g.formPreview()}),y.bind("submit",function(){if(v.doCheck()){var e=t("#crednotificationdiv");return e.hasClass("closed")&&(e.removeClass("closed"),d.forceValidation(),s(),d.isValid&&e.addClass("closed")),d.isValid?t("#_cred_form_not_valid").remove():y.append('<input style="display:none" type="hidden" id="_cred_form_not_valid" name="_cred[validation][fail]" value="1" />'),!0}return!1});var p=t("#cred-shortcodes-box");return p.on("click","a.cred-fields-group-heading",function(e){e.stopPropagation(),e.preventDefault();var i=t(this).next();t("#cred-shortcodes-box-inner .cred-accordeon-item").removeClass("cred-accordeon-item-active"),t(this).closest(".cred-accordeon-item").addClass("cred-accordeon-item-active"),t("#cred-shortcodes-box-inner .cred-accordeon-item-inside").not(i).stop(!1).slideUp("fast"),i.stop(!1).slideDown({duration:"slow",easing:"quintEaseOut"})}),p.on("click","a.cred_field_add",function(e){e.stopPropagation(),e.preventDefault();var i,a=t(this),s=a.data("field");if(y.find(".additional_field_options_popup").remove(),"credform"==s.slug)i="minimal"==r.get("[form][theme]")?"["+s.slug+' class="cred-form cred-keep-original"]\n[/'+s.slug+"]":"["+s.slug+' class="cred-form"]\n[/'+s.slug+"]";else{if("image"==s.type)return t(t("#cred_image_dimensions_validation_template").html()).appendTo("#cred-shortcodes-box"),t("#cred_image_dimensions_validation").__show(),t("#cred_image_dimensions_cancel_button").unbind("click").click(function(e){e.stopPropagation(),e.preventDefault(),setTimeout(function(){t("#cred_image_dimensions_validation").__hide()},50)}),t("#cred_image_dimensions_validation_button").unbind("click").click(function(e){e.stopPropagation(),e.preventDefault();var a=parseInt(t.trim(t("#cred_max_width").val()),10),o=parseInt(t.trim(t("#cred_max_height").val()),10);i=g.shortcode(s,{max_width:a,max_height:o}),n.InsertAtCursor(t("#content"),i),n.dispatch("cred.insertField"),setTimeout(function(){t("#cred-shortcodes-box").__hide(),t("#cred-shortcode-button").css("z-index",1)},50)}),!1;if("textfield"==s.type||"textarea"==s.type||"wysiwyg"==s.type||"date"==s.type||"url"==s.type||"phone"==s.type||"numeric"==s.type||"email"==s.type)return t(t("#cred_text_extra_options_template").html()).appendTo("#cred-shortcodes-box"),t("#cred_text_extra_options").__show(),t("#cred_text_extra_options_cancel_button").unbind("click").click(function(e){e.stopPropagation(),e.preventDefault(),setTimeout(function(){t("#cred_text_extra_options").__hide()},50)}),t("#cred_text_extra_options_button").unbind("click").click(function(e){e.stopPropagation(),e.preventDefault();var a=t.trim(t("#cred_text_extra_placeholder").val()),o=t("#cred_text_extra_readonly").is(":checked"),r=!1;i=g.shortcode(s,{placeholder:a,readonly:o,escape:r}),n.InsertAtCursor(t("#content"),i),n.dispatch("cred.insertField"),setTimeout(function(){t("#cred-shortcodes-box").__hide(),t("#cred-shortcode-button").css("z-index",1)},50)}),!1;if(s.is_parent)return t(t("#cred_parent_field_settings_template").html()).appendTo("#cred-shortcodes-box"),t("#cred_parent_field_settings #cred_parent_required").unbind("change").bind("change",function(){t(this).is(":checked")?(t("#cred_parent_field_settings #cred_parent_select_text_container").stop(!0).slideFadeDown("fast"),t("#cred_parent_field_settings #cred_parent_no_parent_container").stop(!0).slideFadeUp("fast")):(t("#cred_parent_field_settings #cred_parent_select_text_container").stop(!0).slideFadeUp("fast"),t("#cred_parent_field_settings #cred_parent_no_parent_container").stop(!0).slideFadeDown("fast"))}),t("#cred_parent_select_text").val("--- Select "+s.data.post_type+" ---"),t("#cred_parent_validation_text").val(s.data.post_type+" must be selected"),t("#cred_parent_no_parent_text").val("No Parent"),setTimeout(function(){t("#cred_parent_field_settings #cred_parent_required").trigger("change")},50),t("#cred_parent_field_settings").__show(),t("#cred_parent_extra_cancel_button").unbind("click").click(function(e){e.stopPropagation(),e.preventDefault(),setTimeout(function(){t("#cred_parent_field_settings").__hide()},50)}),t("#cred_parent_extra_button").unbind("click").click(function(e){e.stopPropagation(),e.preventDefault();var a=t("#cred_parent_order_by").val(),o=t("#cred_parent_ordering").val(),r=parseInt(t.trim(t("#cred_parent_max_results").val()),10),l=t("#cred_parent_required").is(":checked"),c=t("#cred_parent_no_parent_text").val(),d=t("#cred_parent_select_text").val(),u=t("#cred_parent_validation_text").val();i=g.shortcode(s,{parent_order:a,parent_ordering:o,parent_max_results:r,required:l,no_parent_text:c,select_parent_text:d,validate_parent_text:u}),n.InsertAtCursor(t("#content"),i),n.dispatch("cred.insertField"),setTimeout(function(){t("#cred-shortcodes-box").__hide(),t("#cred-shortcode-button").css("z-index",1)},50)}),!1;i=g.shortcode(s)}n.InsertAtCursor(t("#content"),i),n.dispatch("cred.insertField"),setTimeout(function(){t("#cred-shortcodes-box").__hide(),t("#cred-shortcode-button").css("z-index",1)},50)}),t("#cred-scaffold-box").on("click","#cred-scaffold-insert",function(e){e.stopPropagation(),e.preventDefault();var i=t("#cred-scaffold-area").val();n.InsertAtCursor(t("#content"),i),n.dispatch("cred.insertScaffold"),setTimeout(function(){t("#cred-scaffold-box").__hide(),t("#cred-scaffold-button").css("z-index",1)},50)}),y.on("click","#cred-shortcode-button-button",function(e){e.stopPropagation(),e.preventDefault(),y.find(".cred-media-button").css("z-index",1),y.find(".cred-popup-box").hide(),t(this).closest(".cred-media-button").css("z-index",100),y.find(".additional_field_options_popup").hide(),t("#cred-shortcodes-box").__show(),0===t(".cred-accordeon-item-active").length&&t(".cred-accordeon-item:first-child").addClass("cred-accordeon-item-active").find(".cred-accordeon-item-inside").stop().slideDown("fast")}),y.on("click","#cred-generic-shortcode-button-button",function(e){e.stopPropagation(),e.preventDefault(),y.find(".cred-media-button").css("z-index",1),y.find(".cred-popup-box").hide(),t(this).closest(".cred-media-button").css("z-index",100),t("#cred-generic-shortcodes-box").__show()}),t("#cred_include_captcha_scaffold").change(function(){g.genScaffold()}),t("#cred_include_wpml_scaffold").change(function(){g.genScaffold()}),y.on("click","#cred-scaffold-button-button",function(e){return e.stopPropagation(),e.preventDefault(),y.find(".cred-media-button").css("z-index",1),y.find(".cred-popup-box").hide(),g.genScaffold()?(t(this).closest(".cred-media-button").css("z-index",100),t("#cred-scaffold-box").__show(),void 0):!1
}),y.on("click",".cred-icon-button",function(e){e.stopPropagation(),e.preventDefault(),y.find(".cred-media-button").css("z-index",1),y.find(".cred-popup-box").hide(),t(this).closest(".cred-media-button").css("z-index",100),t(this).next(".cred-popup-box").__show()}),t(document).mouseup(function(e){0===y.find(".cred-popup-box").filter(function(){return t(this).is(":visible")}).has(e.target).length&&(y.find(".cred-media-button").css("z-index",1),y.find(".cred-popup-box").hide())}),t(document).keyup(function(e){e.keyCode==c&&(y.find(".cred-media-button").css("z-index",1),y.find(".cred-popup-box").hide())}),y.on("click",".cred-cred-cancel-close",function(){y.find(".cred-media-button").css("z-index",1),y.find(".cred-popup-box").hide()}),this}}),p=i.settingsurl,t("#titlediv").prepend('<p class="cred-explain-text">'+i.locale.title_explain_text+"</p>").prepend('<a id="cred_add_forms_to_site_help" class="cred-help-link" style="position:absolute;top:0;right:0;" href="'+i.help.add_forms_to_site.link+'" target="_blank" title="'+i.help.add_forms_to_site.text+'">'+i.help.add_forms_to_site.text+"</a>"),_.prepend('<p class="cred-explain-text">'+i.locale.content_explain_text+"</p>"),y.append('<input id="cred-submit" type="submit" class="button button-primary button-large" value="'+i.locale.submit_but+'" />'),_.detach().appendTo("#credformcontentdiv .inside"),b.length>0&&(b.insertAfter(_),b.addClass("cred-exclude")),y.find(".cred_related").removeClass("hide-if-js"),w.hide(),t("#postbox-container-1").find(".cred_related").length||(t("#postbox-container-1").hide(),t("#post-body").removeClass("columns-2").addClass("columns-1"),t("#poststuff").removeClass("has-right-sidebar"),t("#poststuff .inner-sidebar").hide());var $=n.addEditorSwitchButton(i.locale.text_button_title).addClass("switch-text").click(g.toggleHighlight),x=n.addEditorSwitchButton(i.locale.syntax_button_title).addClass("switch-syntax").click(g.toggleHighlight);d?(n.waitUntilElement("#ed_toolbar .ed_button",function(){x.trigger("click"),g.makeResizable(t("#content"))}),o===e.cred_send_to_editor&&(e.cred_send_to_editor=e.send_to_editor,e.send_to_editor=function(e){try{if(wpActiveEditor){var i=n.isCodeMirror(t("#"+wpActiveEditor));if(i){n.InsertAtCursor(t("#"+wpActiveEditor),e.replace(/%%NL%%/g,h));try{tb_remove()}catch(a){}return}}}catch(a){}cred_send_to_editor(e)})):n.waitUntilElement("#ed_toolbar .ed_button",function(){$.trigger("click"),g.makeResizable(t("#content"))}),g.enableExtraCodeMirror(),b.length>0&&(t("#cred-extra-css-editor").hasClass("cred-always-open")||t("#cred-extra-js-editor").hasClass("cred-always-open")?b.removeClass("closed"):b.addClass("closed")),l.init().autobind(!0).bind(["change","click"],"#post").sync(),r.trigger("change",{key:"[post][post_type]",value:r.get("[post][post_type]")}),u=!1}};e.cred_cred=v}(window,jQuery,cred_settings,cred_utils,cred_gui,cred_mvc);